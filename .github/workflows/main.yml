name: CI on Push and Pull Request

on: [push, pull_request]

jobs:
  Practice:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v1
    - name: Run a one-line script
      run: echo Hello, world!
    - name: Run a multi-line script
      run: |
        echo Add other actions to build,
        echo test, and deploy your project.
    - name: Show what's in the directory
      run: |
        ls
    - name: Show what all is in the parent directory
      run: |
        cd ..
        ls
        
  Android:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@v1
    - name: Android
      run: |
        nuget restore Pla.Mobile.sln
        cd Pla.Mobile
        cd Pla.Mobile.Android
        ls
        # debug
        # msbuild Pla.Mobile.Android.csproj /verbosity:normal /t:Rebuild /p:Configuration=Debug
        msbuild /p:Configuration=Release /t:PackageForAndroid  Pla.Mobile.Android.csproj
        # here we artefact Pla/Pla/Pla.Mobile/Pla.Mobile.Android/bin/Release/com.companyname.pla.mobile.apk
        #let's sign the app
        cat KEYSTORE | base64 --decode > keystore
        
        jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore keystore -storepass KEYSTORE_PASSWORD -signedjar pla_signed.apk bin/Release/com.companyname.pla.mobile.apk Pla
        zipalign -f -v 4 pla_signed.apk pla
        
        
  #iOS:
  #  runs-on: macos-latest
  #  steps:
  #  - uses: actions/checkout@v1
  #  - name: iOS
  #    run: |
  #      nuget restore Pla.Mobile.sln
  #      cd Pla.Mobile
  #      msbuild Pla.Mobile.iOS/Blank.iOS.csproj /verbosity:normal /t:Rebuild /p:Platform=iPhoneSimulator /p:Configuration=Debug
